<header class="header" [class.scrolled]="isScrolled">
  <nav class="navbar">
    <div class="container">
      <div class="nav-content">
        <!-- Bouton menu mobile -->
        <button
          class="mobile-menu-btn"
          (click)="toggleMenu()"
          [class.active]="isMenuOpen"
          [attr.aria-label]="isMenuOpen ? 'Fermer le menu' : 'Ouvrir le menu'"
          [attr.aria-expanded]="isMenuOpen"
        >
          <span class="menu-icon">{{ isMenuOpen ? '‚úï' : '‚ò∞' }}</span>
        </button>
        
        <!-- Logo -->
        <div class="logo">
          <a routerLink="/" class="logo-link" (click)="closeMenu()">
            <span class="logo-icon">TechZone</span>
          </a>
        </div>
        
        <!-- ‚úÖ Recherche Mobile : TOUJOURS VISIBLE SUR MOBILE, ind√©pendante du menu -->
        <div class="mobile-search" *ngIf="isMobile">
          <input
            type="text"
            placeholder="Rechercher un produit..."
            [(ngModel)]="searchQuery"
            (keyup.enter)="onSearch()"
            class="search-input"
          >
          <button class="search-btn" (click)="onSearch()">üîç</button>
        </div>
        
        <!-- Recherche Desktop (cach√©e sur mobile) -->
        <div class="search-bar">
          <input
            type="text"
            placeholder="Rechercher un produit..."
            [(ngModel)]="searchQuery"
            (keyup.enter)="onSearch()"
            class="search-input"
          >
          <button class="search-btn" (click)="onSearch()">üîç</button>
        </div>
        
        <!-- Nav Links / Menu Mobile (SANS mobile-search dedans maintenant) -->
        <div class="nav-links" [class.active]="isMenuOpen">
          <!-- Liens navigation -->
          <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" (click)="closeMenu()">
            Accueil
          </a>
          <a routerLink="/products" routerLinkActive="active" (click)="closeMenu()">
            Produits
          </a>
          
          <!-- Cat√©gories Mobile (dans le menu seulement) -->
          @if (isMobile && categories.length > 0) {
            <div class="mobile-categories">
              <h3 class="categories-title">üìÇ Cat√©gories</h3>
              @for (category of categories; track category) {
                <a
                  [routerLink]="['/products']"
                  [queryParams]="{category: category}"
                  class="category-item"
                  routerLinkActive="active"
                  (click)="closeMenu()"
                >
                  {{ formatCategory(category) }}
                </a>
              }
            </div>
          }
          
          @if (isAuthenticated) {
            <a routerLink="/cart" routerLinkActive="active" class="cart-link" (click)="closeMenu()">
              üõí Panier
              @if (cartItemCount > 0) {
                <span class="badge">{{ cartItemCount }}</span>
              }
            </a>
            <div class="user-menu">
              <span class="user-name">üëã {{ currentUser?.firstName || 'User' }}</span>
              <button class="btn-logout" (click)="logout()">D√©connexion</button>
            </div>
          } @else {
            <a routerLink="/login" class="btn-login" (click)="closeMenu()">Connexion</a>
          }
        </div>
      </div>
    </div>
  </nav>
  
  <!-- Barres cat√©gories (desktop seulement) -->
  <div class="categories-bar" *ngIf="!isMobile">
    <div class="container">
      <div class="categories-list">
        @for (category of categories; track category) {
          <a
            [routerLink]="['/products']"
            [queryParams]="{category: category}"
            class="category-item"
            routerLinkActive="active"
          >
            {{ formatCategory(category) }}
          </a>
        }
      </div>
    </div>
  </div>
</header>